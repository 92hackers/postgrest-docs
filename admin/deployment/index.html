<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Joe Nelson">
        <link rel="canonical" href="http://postgrest.com/admin/deployment/">
        <link rel="shortcut icon" href="../../../../favicon.ico">
        

	<title>Deployment - PostgREST</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../..">PostgREST</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Install <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../install/server/">The Server</a>
</li>

                        
                            
<li >
    <a href="../../install/ecosystem/">Ecosystem</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">API <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../api/reading/">Reading</a>
</li>

                        
                            
<li >
    <a href="../../api/writing/">Writing</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Admin <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../security/">Security</a>
</li>

                        
                            
<li >
    <a href="../versioning/">Versioning</a>
</li>

                        
                            
<li >
    <a href="../migration/">Migration</a>
</li>

                        
                            
<li class="active">
    <a href="./">Deployment</a>
</li>

                        
                            
<li >
    <a href="../performance/">Performance</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Examples <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../examples/start/">Getting Started</a>
</li>

                        
                            
<li >
    <a href="../../examples/users/">User Management</a>
</li>

                        
                            
<li >
    <a href="../../examples/blog/">Multi-Tenant Blog</a>
</li>

                        
                            
<li >
    <a href="../../examples/external_auth/">External Authentication</a>
</li>

                        
                            
<li >
    <a href="../../examples/python-requests-jwt/">Python Client</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li >
                        <a rel="next" href="../migration/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../performance/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                
                
                    <li>
                        <a href="https://github.com/begriffs/postgrest-docs">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#deployment">Deployment</a></li>
        
            <li><a href="#heroku">Heroku</a></li>
        
            <li><a href="#debian">Debian</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h2 id="deployment">Deployment</h2>
<h3 id="heroku">Heroku</h3>
<h4 id="account-setup-on-heroku">Account setup on Heroku</h4>
<p>Setting up a simple Heroku “Free Account” is easy and should take no more than a couple of minutes. For this guide I will be using a fictitious email account “postgrest@kismail.ru” to set up the account on Heroku. You can use whatever email account you desire.
NOTE: During signup you will be asked to “Pick your primary development language”. It is safe here to choose any language or simply “I use another language”.</p>
<ol>
<li>Heroku signup input <img alt="Heroku signup input" src="../../img/heroku_guide/1_heroku_signup_input.png" /></li>
<li>Heroku signup waiting <img alt="Heroku signup waiting" src="../../img/heroku_guide/2_heroku_signup_waiting.png" /></li>
<li>Heroku signup confirmation <img alt="Heroku signup confirmation" src="../../img/heroku_guide/3_heroku_signup_confirmation.png" /></li>
<li>Heroku signup password <img alt="Heroku signup password" src="../../img/heroku_guide/4_heroku_signup_password.png" /></li>
<li>Heroku signup success <img alt="Heroku signup success" src="../../img/heroku_guide/5_heroku_signup_success.png" /></li>
</ol>
<p>After initial signup, you will receive a confirmation email. You have to open the link provided in the email to activate your Heroku Free Account.</p>
<h4 id="new-app-setup-in-heroku">New “App” setup in Heroku</h4>
<p>Creating an “App” can be seen as creating an environment, complete with hardware resources, to run any code you wish. It is here that the PostgreSQL database and the PostgREST instance will reside.</p>
<p>Select “New App” and then select a new name for the “App”. It can be anything as long as it is available. The “Run-time Selection” region can be anywhere, it only specifies where the app data is stored.</p>
<ol>
<li>Heroku initial empty page <img alt="Heroku initial empty page" src="../../img/heroku_guide/6_heroku_initial_empty_page.png" /></li>
<li>Heroku create new app <img alt="Heroku create new app" src="../../img/heroku_guide/7_heroku_create_new_app.png" /></li>
<li>Heroku app creation success <img alt="Heroku app creation success" src="../../img/heroku_guide/8_heroku_app_created_success.png" /></li>
</ol>
<h4 id="setup-of-postgresql-add-on-in-newly-setup-app">Setup of PostgreSQL add-on in newly setup “App”</h4>
<p>At this point you should have your new “App” environment setup and running. 
It is now time to add a PostgreSQL database to your “App”.
In your “App” screen, you will have several tabs with names such as “Overview”, “Resources”, “Deploy”, etc. </p>
<ol>
<li>Choose “Resources”. This will show you the resources currently running in your “App”, which should be empty as you have yet to deploy any resources.</li>
<li>On the “Resources” page, under the header “Add-ons” you will find a search bar. Type in “PostgreSQL”, which will show you “Heroku PostgreSQL”. Click on the name to show a deployment dialog. <img alt="Heroku find postgresql db" src="../../img/heroku_guide/9_heroku_find_postgresql_db.png" />
<img alt="Heroku install postgresql db" src="../../img/heroku_guide/10_heroku_install_postgresql_db.png" /></li>
<li>After deployment, you will see a line in your “Add-ons” named “Heroku PostgreSQL”. You have now added a PostgreSQL database to your “App”. Now to setup the database.
NOTE: It might take a few minutes for Heroku to initialize the db, so please wait 1-2 minutes before moving on to step 4. <img alt="Heroku installed postgresql db" src="../../img/heroku_guide/11_heroku_installed_postgresql_db.png" /></li>
<li>Click on the newly added “Heroku PostgreSQL” in your “Add-ons” and you will be taken to the database “Overview” page. Here you will find all the information necessary to find and connect to your PostgreSQL DB. This information will be very important when setting up PostgREST.
<img alt="Heroku db panel" src="../../img/heroku_guide/12_heroku_db_panel.png" />
<img alt="Heroku db overview" src="../../img/heroku_guide/13_heroku_db_overview.png" />
<img alt="Heroku db stats" src="../../img/heroku_guide/14_heroku_db_stats.png" />
<img alt="Heroku db success" src="../../img/heroku_guide/15_heroku_app_with_db.png" /></li>
<li>At this point, you have full access to the PostgreSQL database and can create tables, schemas, functions, etc. 
NOTE: The PostgREST setup will only work against a single Schema. This means that tables outside of the selected Schema will not be directly accessible via API calls. </li>
</ol>
<h4 id="testing-of-newly-setup-postgresql">Testing of newly setup PostgreSQL</h4>
<p>Before we move on to deploying PostgREST, we could perform a quick test to see that our DB is up and running. This can be done in many different ways, one of which is the <a href="http://agileforce.co.uk/heroku-workshop/heroku-postgres/pgadmin.html">pgAdmin GUI</a>. It is also possible to connect with psql for simple testing.</p>
<p>NOTE: When using pgAdmin to connect to the DB, you will see many other inaccessible DBs. Don’t be alarmed. Find your DB by the “Database“ name provided in the Overview.</p>
<h4 id="setup-of-postgrest-deployment">Setup of PostgREST deployment</h4>
<p>Now it is time to deploy PostgREST. The PostgREST deployment on Heroku is not an “Add-on”, it is an “Element”. It can be found by opening the menu at the top right of the Heroku screen and selecting “Elements”. Search for “PostgREST” and find it under “Buttons”. Opening the “PostgREST” page, a “Deploy to Heroku” button will be present on the page. This button will lead to the initial setup and configuration page for the PostgREST deployment on your “App”.</p>
<ol>
<li>Heroku find PostgREST 1 <img alt="Heroku find Postgrest 1" src="../../img/heroku_guide/16_heroku_find_postgrest_1.png" /></li>
<li>Heroku find PostgREST 2 <img alt="Heroku find Postgrest 2" src="../../img/heroku_guide/17_heroku_find_postgrest_2.png" /></li>
<li>Heroku PostgREST page <img alt="Heroku PostgREST page" src="../../img/heroku_guide/18_heroku_postgrest_page.png" /></li>
<li>Heroku PostgREST install <img alt="Heroku PostgREST install" src="../../img/heroku_guide/19_heroku_postgrest_installation.png" /></li>
</ol>
<p>Explanations for each field in the PostgREST setup page:</p>
<ul>
<li><strong>App Name</strong> (optional) : The name chosen for the PostgREST deployment. 
NOTE: The name you choose will be the beginning of your specific API url. So if you choose “bugbunny”, your API url will be “bugbunny.herokuapp.com”.</li>
<li><strong>Run-time Selection</strong> : Simply select the region the deployment (basically data) will be stored.</li>
<li><strong>BUILDPACK_URL</strong> : Do not change this. This points to the pack that will be used for setup, which cannot be changed if you want a functioning PostgREST.</li>
<li><strong>POSTGREST_VER</strong> : Do not change this. Version of PostgREST used for installation.</li>
</ul>
<p>PostgREST configuration (Information from the PostgreSQL Overview page):</p>
<ul>
<li><strong>DB_NAME</strong> : Here you must provide the name of the database you setup earlier, which can be found on the “Overview” page of the PostgreSQL add-on. It should be something like “d41vontrqmq2oo”.</li>
<li><strong>AUTH_ROLE</strong> : This is the role of an authenticated user. All authenticated calls to the API will use this user role when attempting to perform actions against the PostgreSQL database. User authentication is done using the procedure described on the <a href="../../admin/security/">Security page</a>. :w
For the purpose of this demo, you can simply input the data in the “User” field of the Overview page of the PostgreSQL add-on. It should be something like “nhvnhzryphzmcp”.</li>
<li><strong>AUTH_PASS</strong> : Simply the password for the authenticated user, also found on the Overview page of the PostgreSQL add-on. It should be something like “5YDLXynT2ZWqUA6c2c_D12TofA”.</li>
<li><strong>ANONYMOUS_ROLE</strong> : This is the role for any unauthenticated call to the API. In a regular PostgreSQL database this role could be for calls that for example don’t alter data, but simply retrieve data. Unfortunately in Heroku Hobby-dev account, it is not possible to add any roles to your PostgreSQL database, which means you will have to use the only role provided when PostgreSQL is setup, the admin role. So input the same data provided in the “AUTH_ROLE” field.
Please keep in mind that this admin role has full access and can do anything, including deleting from the db.</li>
<li><strong>DB_HOST</strong> : This is the URL to the database, which should be copied directly from the Overview page of the PostgreSQL add-on.</li>
<li><strong>DB_PORT</strong> : The port to used when connecting to the database. Usually not necessary to change unless some specific manual changes have been made to the DB connection.</li>
<li><strong>DB_POOL</strong> : As the description states, “Maximum number of connections in database pool”. This parameter is not necessary to change.</li>
<li><strong>JWT_SECRET</strong> : Information regarding this parameter can be found in the <a href="../../admin/security/">Security page</a>. For testing purposes, there is no need to change this parameter, but it is important to read and fully understand how JWT works if and when moving on from testing only.</li>
<li><strong>SCHEMA</strong> : This parameter is very important when it comes to being able to access the information on the PostgreSQL DB via PostgREST, as it indicates what Schema on the DB should be made available through the API calls. Only a single Schema can be selected and the tables and views in that Schema will be accessible through the API, so please make sure that the correct Schema name is input here.</li>
</ul>
<p>When all the above fields are filled in, the PostgREST configuration should be ready for deployment. Pressing the “Deploy for free” button at the bottom of the screen will initiate the deployment process, which should take no more than a 1-2 minutes to finish.
<img alt="Heroku PostgREST installing" src="../../img/heroku_guide/20_heroku_postgrest_installing.png" />
<img alt="Heroku PostgREST installed" src="../../img/heroku_guide/21_heroku_postgrest_installed.png" /></p>
<h4 id="testing-the-postgrest-deployment">Testing the PostgREST deployment</h4>
<p>At this point, you should have the PostgreSQL database and the PostgREST Heroku element up and running. Time to test the setup. 
The easiest way to see if things are up and running is to go to your “Personal Apps” in your Heroku dashboard, select the name you selected when deploying PostgREST (like “bugbunny”) and then pressing the “Open app” button at the top, right corner of the screen. What should open is a new web page, with a JSON representation of the tables in your PostgreSQL database. (https://bugbunny.herokuapp.com/)
<img alt="Heroku postgrest test 1" src="../../img/heroku_guide/22_heroku_postgrest_test_1.png" /></p>
<p>An additional test to perform is to add the name of any table inside you database Schema to the end of the PostgREST Heroku app URL, such as https://bugbunny.herokuapp.com/people, where “people” is the name of the Table in the database Schema. This will retrieve, in JSON form, all the rows in the “People” table.</p>
<p><img alt="Heroku postgrest test 1" src="../../img/heroku_guide/23_heroku_postgrest_test_2.png" /></p>
<p>Heroku LINKS:</p>
<ul>
<li><a href="https://devcenter.heroku.com/articles/heroku-postgres-plans">Heroku PostgreSQL Plans</a></li>
<li><a href="https://elements.heroku.com/buttons/begriffs/postgrest">Heroku PostgREST</a></li>
</ul>
<h3 id="debian">Debian</h3>
<p>(To be written)</p></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>
